<SES pre Tablet>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SES Chapter 4 - part 1</title>
<style>

    body {
        font-family: Arial, sans-serif;
        background-color: #fff;
        font-size: 16px;
        display: flex;
    }
    .ses {
        background-color: #b786db;
        padding: 25px;
        text-align:center;
        font-size: 24px;
    }
    .chapter {
        background-color: #edecf3;
        padding: 20px;
        font-size: 20px;
        text-align:center;
    }
    .headABC {  /* ก., ข., ... */
        background-color: #d2b3e8;
        padding: 15px;
        font-size: 18px;
    }
    .head1 {  /* ข้อ 1., 2., 3., ... */
        background-color: #DEC8EE;
        padding: 15px;
        padding-left: 30px;
        font-size: 16px;
    }
    
    /*--------------------------------*/

    select {
        border-radius: 4px;
        border: 1px solid #ddd;
        box-sizing: border-box;
        font-size: 15px;
        height: 32px;
        width: 120px;
    }
    
    /*--------------------------------*/
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        font-size: 16px;
    }
    table th, table td {
        border: 1px solid #f2f2f2;
        padding: 10px;
        text-align: left;
    }
    table th {
    	font-weight: normal;
        background-color: #DEC8EE;
        text-align: center;
    }
    thead {
        position: sticky;
        top: 0;
        background: #eee;
    }
    
    /*--------------- ITEM ---------------*/
    
   #head1 { /* ข้อ 1., 2., 3., ... */
        background-color: #E9DAF4;
        padding: 15px ;
    }
   #head2 { /* ข้อ 2.1, 2.2, 2.3, ... */
        padding: 15px 35px;
        background-color: #F7EEFC;
    }
   #year {
        background-color: #fff;
    }
   #gray {
        background-color: #f8f6fa;
    }
   #Hsub1 { /* สำหรับ sub head1 */
        padding-left: 35px;
    }
   #Hsub2 { /* สำหรับ sub head2 */
        padding-left: 60px;
    }
   #Hsub3 { /* สำหรับ sub ของ sub head2 */
        padding-left: 80px;
    }
   #HsubG { /* gray */
    	background-color: #f8f6fa;
        padding-left: 60px;
    }
   #total {
        text-align: right;
    	background-color: #F7EEFC;
    }
   #total2 {
        text-align: center;
    	background-color: #F7EEFC;
    }
   #nn {
        padding-left: 30px;
    }
    
    /*--------------- INPUT ---------------*/
    
    input {
        height: 32px;
        padding: 6px;
        border-radius: 4px;
        border: 1px solid #ddd;
        box-sizing: border-box;
        text-align: right;
        display: block;
        margin: 0 auto;
        font-size: 15px;
    }
    input.price, input.year, input.gray, input.total {
        width: 90px;
    }
    input.year {
    	background-color: #F7EEFC;
    }
    input.gray {
    	background-color: #EEEEEE;
        pointer-events: none;
    }
    input.T { /* อื่น ๆ ระบุ */
        width: 200px;
        margin-left: 10px;
        display: inline-block;
    }
    input.Q {
        width: 45px;
        float: left;
        display: inline-block;;
    }
    input.P {
        width: 45px;
    }
    input.QT { /* ระบุหน่วย */
        width: 120px;
        float: left;
        margin-left: 10px;
        display: inline-block;
    }
    input.total {
    	background-color: #EBD5F7;
        display: inline-block;
        pointer-events: none;
    }
    tfoot td {
        font-weight: bold;
    }
    input[type="checkbox"] {
        display: inline-block;
        vertical-align: middle;
    }
    
    /*--------------------------------*/

    .nn {
        background-color: #FFF9E7;
        font-size: 15px;
        padding: 10px;
        padding-left: 20px;
    }  
    .nn2 {
        background-color: #FFF9E7;
        font-size: 15px;
        padding: 10px;
        padding-left: 60px;
    }
    .remark, .remarkR, .remarkL {
        color: #FF0000;
        font-size: 15px;
    }
    .remark {
        text-align:left;
    }
    .remarkL {
        padding-left: 15px;
    }
    .remarkR {
        padding-right: 15px;
    }
    .note {    
        font-size: 18px;
        background-color: #E2EFDA;
        padding: 20px;
        padding-left: 20px;
        margin-top: 50px;
        margin-bottom: 20px;
    }
    .notebox {
        height: 200px;    
        font-size: 16px;
        color: #FF0000;
        background-color: #fff;
        padding: 10px;
        border: 1px solid #000;
        margin-top: 10px;
        white-space: pre-line;
        overflow-y: auto;
    }
    #outer{
        width:100%;
        text-align: center;
    }
    .inner{
        display: inline-block;
    }
    
    /*--------------------------------*/
    
    input[type="number"]::-webkit-outer-spin-button, 
    input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
    }
    input[type="number"] {
    -moz-appearance: textfield;
    }
    
</style>
</head>
<body>

<!----------------------------------------------- HEADDING ----------------------------------------------->

<div class="ses"> <b>การสำรวจภาวะเศรษฐกิจและสังคมของครัวเรือน</b> </div>

<div class="chapter">
    <b>ตอนที่ 4 ค่าใช้จ่ายอาหาร เครื่องดื่ม และยาสูบ</b>
    <div class="remark">
        <u>remark</u>
        <br><b>** เปิดให้บันทึกที่หัวหน้าครัวเรือน **</b>
    	<br>- ข้อไหนไม่มีค่าใช้จ่ายสามารถปล่อย blank ได้ <u>แต่หลังบ้านบันทึกค่าเป็น 0</u>
        <br>- กำหนดค่า default ใน box ให้เป็นชื่อตัวแปรเพื่อความเข้าใจเท่านั้น หน้าโปรแกรมจริงให้เอาออก
    </div>
</div>

<div class="nn">
    ให้บันทึก <b>"จำนวนเงิน"</b> (ถ้าซื้อ/จ่าย) หรือ <b>"มูลค่า"</b> (ถ้าไม่ได้ซื้อ/จ่าย เบิกได้) ของค่าใช้จ่ายแต่ละรายการตาม<b>คาบเวลาที่กำหนดให้</b>
</div>

<div class="headABC"> <b>ก. อาหารแห้ง/สำเร็จรูป ที่เก็บไว้บริโภคได้นาน (เกิน 1 สัปดาห์) (เฉพาะที่บริโภคเป็นประจำสม่ำเสมอ)</b></div>

<table>
  <thead>
  
  	<tr>
  		<th rowspan="2" style="min-width: 285px;"><b>รายการค่าใช้จ่าย</b></th>
  		<th rowspan="2" style="min-width: 110px;"><b>แหล่งที่มา/<br>การได้รับมา</b></th>
  		<th rowspan="2" style="min-width: 90px;"><b>จำนวนเงิน<br>หรือมูลค่า<br>คิดเป็นเงิน</b></th>
  		<th rowspan="2" style="min-width: 175px;"><b>ปริมาณ/หน่วย</b><br>(เช่น กก./ถุง/<br>กล่อง/ขวด ฯลฯ)</th>
  		<th colspan="3"><b>อาหารเหล่านี้ใช้บริโภค<br>ได้นานเท่าใด</b></th>
  		<th colspan="2"><b>จำนวนเงิน หรือมูลค่า<br>ที่บริโภค<br>เฉลี่ยต่อสัปดาห์</b></th>
  	</tr>
    
  	<tr>
  		<th style="min-width: 50px;"><b>เดือน</b></th>
  		<th style="min-width: 50px;"><b>สัปดาห์</b></th>
  		<th style="min-width: 50px;"><b>วัน</b></th>
  		<th style="min-width: 100px;"><b>ซื้อ/จ่าย</b></th>
  		<th style="min-width: 100px;"><b>ไม่ได้ซื้อ/จ่าย<br>เบิกได้ หรือ<br>ผลิตเอง</b></th>
  	</tr>
  
  </thead>
  
<!------------------------------------------------------------------------------------->

    <tbody id="table">

        <tr>
            <td id="head1"></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx_xxS<br>_(A, BC)</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx_xxC<br>_(A, BC)</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx_xxQ, EDFxx_xxQT</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx<br>_xxPM</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx<br>_xxPW</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx<br>_xxPD</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx_xxA</span></td>
            <td id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">EDFxx_xxBC</span></td>
        </tr>

        <tr>
            <td id="head1"><b>1. ข้าว แป้ง และอาหารที่ทำจากแป้ง</b></td>
            <td colspan="2" id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">ติ๊ก EDFxx_xxS_A เพื่อปลดล็อค <br>EDFxx_xxC_A (BC ก็เช่นกัน)</span></td>
            <td colspan="4" id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">ล็อค EDFxx_xxQ - EDFxx_xxPD ไว้ ต้องเลือก EDFxx_xxS ก่อน<br>จึงจะใส่ข้อมูลช่องอื่น ๆ ได้</span></td>
            <td colspan="2" id="head1" style="text-align: center"><span class="remark" style="font-size: 13px;">(โปรแกรมคำนวณให้)</span></td>
        </tr>

        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 10;
                var itemNames = [
                    "ขนมอบ/เค้ก และขนมที่ทำจากแป้งเป็นส่วนใหญ่",
                    "ข้าวเจ้า (ข้าวสาร)",
                    "ข้าวเหนียว (ข้าวสาร)",
                    "แป้งข้าวเจ้า",
                    "แป้งทอดกรอบ/แป้งอเนกประสงค์",
                    "แป้งสาลี แป้งมันสำปะหลัง และแป้งอื่น ๆ",
                    "เส้นหมี่",
                    "วุ้นเส้น",
                    "มักกะโรนี สปาเก็ตตี้",
                    "สาคูและอื่น ๆ<br><br>ระบุ :<input class='T' id='EDF01_10T' placeholder='EDF01_10T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF01_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF01_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF01_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF01_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF01_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF01_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF01_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF01_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF01_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF01_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF01_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF01_"], select[id^="EDF01_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF01A"
                       placeholder="EDF01A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF01BC"
                       placeholder="EDF01BC"
                >
			</td>
		</tr>

<!------------------------------------------------------------------------------------->
        
        <tr>
            <td colspan="9" id="head1"><b>2. เนื้อสัตว์ และสัตว์ปีกทุกชนิด (แปรรูป)</b></td>
        </tr>

        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 4;
                var itemNames = [
                    "หมู/เนื้อเค็มหรือตากแห้ง",
                    "หมูหยอง/ไก่หยอง",
                    "กุนเชียงหมู",
                    "เนื้อกระป๋อง/เนื้อสัตว์ (แปรรูป)อื่น ๆ<br><br>ระบุ :<input class='T' id='EDF02_04T' placeholder='EDF02_04T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF02_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF02_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF02_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF02_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF02_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF02_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF02_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF02_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF02_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF02_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF02_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF02_"], select[id^="EDF02_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF02A"
                       placeholder="EDF02A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF02BC"
                       placeholder="EDF02BC"
                >
			</td>
		</tr>

<!------------------------------------------------------------------------------------->
        
        <tr>
            <td colspan="9" id="head1"><b>3. ปลาและสัตว์น้ำอื่น ๆ</b></td>
        </tr>
        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 5;
                var itemNames = [
                    "ปลาแห้ง ปลาเค็ม<br><br>ระบุระเภทปลา :<input class='T' id='EDF03_01T' placeholder='EDF03_01T'>",
                    "กุ้งแห้ง",
                    "ปูเค็ม",
                    "ปลาร้า",
                    "ปูดอง และสัตว์น้ำ (แปรรูป) อื่น ๆ<br><br>ระบุ :<input class='T' id='EDF03_05T' placeholder='EDF03_05T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF03_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF03_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF03_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF03_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF03_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF03_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF03_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF03_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF03_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF03_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF03_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF03_"], select[id^="EDF03_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF03A"
                       placeholder="EDF03A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF03BC"
                       placeholder="EDF03BC"
                >
			</td>
		</tr>

<!------------------------------------------------------------------------------------->
        
        <tr>
            <td colspan="9" id="head1"><b>4. อาหารประเภทนม เนย เนยแข็งและไข่</b></td>
        </tr>
        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 8;
                var itemNames = [
                    "นมยูเอชที",
                    "นมโรงเรียนทุกประเภท (ได้รับอุดหนุนฟรีจากรัฐ)",
                    "นมถั่วเหลือง",
                    "นมข้นหวาน",
                    "นมผง",
                    "ครีมเทียม",
                    "เนยเทียม",
                    "ไข่เค็ม และอื่น ๆ<br><br>ระบุ :<input class='T' id='EDF04_08T' placeholder='EDF04_08T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF04_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF04_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF04_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF04_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF04_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF04_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF04_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF04_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF04_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF04_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF04_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF04_"], select[id^="EDF04_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF04A"
                       placeholder="EDF04A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF04BC"
                       placeholder="EDF04BC"
                >
			</td>
		</tr>

<!------------------------------------------------------------------------------------->
        
        <tr>
            <td colspan="9" id="head1"><b>5. น้ำมัน และไขมัน</b></td>
        </tr>
        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 5;
                var itemNames = [
                    "น้ำมันพืช",
                    "น้ำมันสัตว์/น้ำมันหมู",
                    "เนยสด น้ำมันเนย",
                    "กะทิกระป๋อง/สำเร็จรูป",
                    "ไขมัน และน้ำมันอื่น ๆ<br><br>ระบุ :<input class='T' id='EDF05_05T' placeholder='EDF05_05T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF05_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF05_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF05_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF05_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF05_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF05_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF05_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF05_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF05_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF05_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF05_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF05_"], select[id^="EDF05_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF05A"
                       placeholder="EDF05A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF05BC"
                       placeholder="EDF05BC"
                >
			</td>
		</tr>

<!------------------------------------------------------------------------------------->
        
        <tr>
            <td colspan="9" id="head1"><b>6. ผลไม้ และถั่วเปลือกแข็ง</b></td>
        </tr>
        
        <script>
        
            function InsertSub() {
                var tableBody = document.getElementById('table');
                var itemCount = 5;
                var itemNames = [
                    "ผลไม้แช่อิ่ม/ดอง/กวน/ตากแห้ง",
                    "ผลไม้กระป๋อง",
                    "ถั่วลิสง",
                    "ผลไม้แปรรูปอื่น ๆ<br><br>ระบุ :<input class='T' id='EDF06_04T' placeholder='EDF06_05T'>",
                    "ถั่วเหลืองและถั่วอื่น ๆ<br><br>ระบุ :<input class='T' id='EDF06_04T' placeholder='EDF06_05T'>"
                ];

                for (var i = 0; i < itemCount; i++) {
                    var row = document.createElement('tr');
                    
                    var ValueSA = "EDF06_" + (i + 1).toString().padStart(2, '0') + "S_A";
                    var ValueSBC = "EDF06_" + (i + 1).toString().padStart(2, '0') + "S_BC";
                    var ValueCA = "EDF06_" + (i + 1).toString().padStart(2, '0') + "C_A";
                    var ValueCBC = "EDF06_" + (i + 1).toString().padStart(2, '0') + "C_BC";
                    var ValueQ = "EDF06_" + (i + 1).toString().padStart(2, '0') + "Q";
                    var ValueQT = "EDF06_" + (i + 1).toString().padStart(2, '0') + "QT";
                    var ValuePM = "EDF06_" + (i + 1).toString().padStart(2, '0') + "PM";
                    var ValuePW = "EDF06_" + (i + 1).toString().padStart(2, '0') + "PW";
                    var ValuePD = "EDF06_" + (i + 1).toString().padStart(2, '0') + "PD";
                    var ValueA = "EDF06_" + (i + 1).toString().padStart(2, '0') + "A";
                    var ValueB = "EDF06_" + (i + 1).toString().padStart(2, '0') + "BC";
                    row.innerHTML = `
                <td id="Hsub1">
                	${itemNames[i]}
                </td>
                
                <td>
                    <input type="checkbox" id="${ValueSA}"> ซื้อ/จ่าย
                    <br>
                    <input type="checkbox" id="${ValueSBC}"> ไม่ได้ซื้อ/จ่าย
                </td>
                    
                <td>
                	<input type="number" class="price" id="${ValueCA}">
                    <br>
                	<input type="number" class="price" id="${ValueCBC}">
                </td>
                
                <td>
                	<input type="number" class="Q" id="${ValueQ}">
                    <input type="text" class="QT" id="${ValueQT}" placeholder="ระบุหน่วย">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePM}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePW}">
                </td>
                
                <td>
                	<input type="number" class="P" id="${ValuePD}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueA}" placeholder="${ValueA}">
                </td>
                
                <td>
                	<input type="number" class="gray" id="${ValueB}" placeholder="${ValueB}">
                </td>
                    `;
                    tableBody.appendChild(row);
                }
            }

            InsertSub();

            document.addEventListener('DOMContentLoaded', function() {
                var inputs = document.querySelectorAll('input[id^="EDF06_"], select[id^="EDF06_"]');
                inputs.forEach(function(input) {
                    input.addEventListener('input', calculateValues);
                });
            });
            
        </script>
        
<!-------------------------------------------------------->
        
    	<tr>
            <td id="total" colspan="7"><span class="remarkR">(โปรแกรมคำนวณให้)</span><b>รวม</b></td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF06A"
                       placeholder="EDF06A"
                >
			</td>
            <td id="total2">
            	<input class="total"
                	   type="number"
                       id="EDF06BC"
                       placeholder="EDF06BC"
                >
			</td>
		</tr>
        
    </tbody>
    
</table>


<!-------------------------------------------- NOTE -------------------------------------------->

<div class="note">
  <b>NOTE :</b>
  <span class="remark">(C4.1_NOTE)</span>
  <div id="rec04_note" class="notebox" contenteditable="true">*** เพิ่มฟังก์ชันพิมพ์ด้วยเสียง ***</div>
</div>

<div id="outer">
  <div class="inner"><button onclick="back()">Back</button></div>
  <div class="inner"><button onclick="index()">Index</button></div>
  <div class="inner"><button onclick="next()">Next</button></div>
</div>

<button onclick="resetLocalStorage()">Reset localStorage</button>

<!----------------------------------------------------------------------------------------------------------->

<script>

<!--------------------------------------------------------------------->

function back() {
    saveToLocalStorage();
    window.location.href = 'Chapter 3 - part 6.html';}

<!--------------------------------------------------------------------->

function index() {
    saveToLocalStorage();
    window.location.href = 'index.html';}

<!--------------------------------------------------------------------->

function next() {
    saveToLocalStorage();
    window.location.href = 'Chapter 4 - part 2.html';}

<!--------------------------------------------------------------------->

    var elements = document.querySelectorAll("[id]");
    var inputIds = Array.from(elements).map(function(element) {
        return element.id;
    });
    
<!--------------------------------------------------------------------->

function saveToLocalStorage() {
    inputIds.forEach(function(id) {
        var element = document.getElementById(id);
        if (element.type === 'checkbox') {
            localStorage.setItem(id, element.checked ? 1 : 0);
        } else {
            localStorage.setItem(id, element.value);
        }
    });
}

<!--------------------------------------------------------------------->

function resetLocalStorage() {
    localStorage.clear();
    alert("localStorage has been reset.");

    window.onload();
}

<!--------------------------------------------------------------------->

window.onload = function() {
    inputIds.forEach(function(id) {
        var element = document.getElementById(id);

        // สำหรับ input elements
        if (element.type === 'checkbox') {
        	element.addEventListener('change', function() {
        		saveToLocalStorage();
        	});
        	var value = localStorage.getItem(id);
        	if (value !== null) {
        		element.checked = value == 1;
        	} else {
        		element.checked = false;
        	}
        } else {
        	element.addEventListener('input', function() {
        		saveToLocalStorage();
        		calculateValues();
        	});
        	var value = localStorage.getItem(id);
        	if (value !== null) {
        		element.value = value;
        	} else {
        		element.value = "";
        	}
        }
    });
    saveToLocalStorage();
    calculateValues();
};

<!--------------------------------------------------------------------->

function calculateValues() {
    const jLimits = { 1: 10, 2: 4, 3: 5, 4: 8, 5: 5, 6: 5};

    for (let i = 1; i <= 6; i++) {
        const jLimit = jLimits[i];
        let TotalA = 0;
        let TotalB = 0;

        for (let j = 1; j <= jLimit; j++) {
            const iStr = i.toString().padStart(2, '0');
            const jStr = j.toString().padStart(2, '0');
            const SA = document.getElementById(`EDF${iStr}_${jStr}S_A`).checked ? 1 : 0;
            const SBC = document.getElementById(`EDF${iStr}_${jStr}S_BC`).checked ? 1 : 0;
            const CA = parseInt(document.getElementById(`EDF${iStr}_${jStr}C_A`).value) || 0;
            const CBC = parseInt(document.getElementById(`EDF${iStr}_${jStr}C_BC`).value) || 0;
            const PM = parseInt(document.getElementById(`EDF${iStr}_${jStr}PM`).value) || 0;
            const PW = parseInt(document.getElementById(`EDF${iStr}_${jStr}PW`).value) || 0;
            const PD = parseInt(document.getElementById(`EDF${iStr}_${jStr}PD`).value) || 0;
            const A = document.getElementById(`EDF${iStr}_${jStr}A`);
            const B = document.getElementById(`EDF${iStr}_${jStr}BC`);

            setPointerEventsAndBackground(`EDF${iStr}_${jStr}C_A`, SA ? "auto" : "none", SA ? "#fff" : "#EEEEEE");
            if (!SA) document.getElementById(`EDF${iStr}_${jStr}C_A`).value = "";

            setPointerEventsAndBackground(`EDF${iStr}_${jStr}C_BC`, SBC ? "auto" : "none", SBC ? "#fff" : "#EEEEEE");
            if (!SBC) document.getElementById(`EDF${iStr}_${jStr}C_BC`).value = "";

            if (SA || SBC) {
                const base = (PM * 4.3) + PW + (PD / 7);
                const A_result = CA / base;
                const B_result = CBC / base;

                if (!isNaN(A_result)) {
                    A.value = Math.round(A_result);
                    TotalA += A_result;
                }
                if (!isNaN(B_result)) {
                    B.value = Math.round(B_result);
                    TotalB += B_result;
                }
                setRelatedElementsState(iStr, jStr, "auto", "#fff");
            } else {
                clearAndDisableElements(iStr, jStr, A, B);
            }
            calculateTotal(i, TotalA, TotalB);
        }
    }
}

function setPointerEventsAndBackground(elementId, pointerEvents, backgroundColor) {
    const element = document.getElementById(elementId);
    if (element) {
        element.style.pointerEvents = pointerEvents;
        element.style.backgroundColor = backgroundColor;
    }
}

function setRelatedElementsState(iStr, jStr, pointerEvents, backgroundColor) {
    const elements = ['Q', 'QT', 'PM', 'PW', 'PD'];
    elements.forEach(el => setPointerEventsAndBackground(`EDF${iStr}_${jStr}${el}`, pointerEvents, backgroundColor));
}

function clearAndDisableElements(iStr, jStr, A, B) {
    A.value = '';
    B.value = '';
    setRelatedElementsState(iStr, jStr, "none", "#EEEEEE");
    ['Q', 'QT', 'PM', 'PW', 'PD'].forEach(el => document.getElementById(`EDF${iStr}_${jStr}${el}`).value = "");
}

function calculateTotal(i, TotalA, TotalB) {
    const EDFiA = document.getElementById(`EDF${i.toString().padStart(2, '0')}A`);
    const EDFiBC = document.getElementById(`EDF${i.toString().padStart(2, '0')}BC`);
    EDFiA.value = TotalA === 0 ? '' : Math.round(TotalA);
    EDFiBC.value = TotalB === 0 ? '' : Math.round(TotalB);
}

</script>

</body>
</html>
